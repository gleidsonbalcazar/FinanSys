<div class="container container-fluid">
  <div class="row">
    <div class="col-8">
      <div class="card resume" >
      <div class="card-header">
        <div class="row align-items-center">
          <div class="col-9">Orçamentos</div>
          <div class="col-3">
            <form>
              <div >
                <div class="row justify-content-center">
                  <div class="col-3">
                    <button (click)="addBudget()" class="btn btn-primary">
                      Adicionar
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>


      </div>
        <div class="card-body">
          <table id="tableBudgets" class="table table-striped">
            <thead>
              <tr>
                <th scope="col">Descrição</th>
                <th scope="col">Valor</th>
                <th scope="col">Mês</th>
                <th scope="col">Tipo</th>
                <th scope="col">Ações</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let budget of budgets">
                <td>{{ budget.description }}</td>
                <td [ngClass]="budget.typeBudget === 'R' ? 'line-r' : 'line-d'">
                  {{ budget.value | currency: "EUR":true }}
                </td>
                <td>{{ getMonthById(budget.month) }}</td>
                <td>{{ budget.default ? "Padrão" : "" }}</td>
                <td>
                  <span (click)="editBudget(budget)"
                    ><i class="fas fa-pen fa-fw" style="cursor: hand"></i
                  ></span>
                  <span (click)="deleteBudget(budget)"
                    ><i class="fas fa-trash fa-fw" style="cursor: hand"></i
                  ></span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        </div>
    </div>
    <div class="col-4">
      <div class="card resume" >
        <div class="card-header">Indicadores</div>
        <div class="card-body">
          <p style="cursor: pointer;color: blue;" (click)="openIndicator('Orçamento Planejado x Orçamento Executado')">Orçamento Planejado x Orçamento Executado</p>
        </div>
      </div>
    </div>
</div>

<modal #modal [modalConfig]="modalConfig">
  <form [formGroup]="myForm">
    <div class="form-group">
      <div class="form-group ml-3">
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            value="R"
            formControlName="typeBudget"
          />
          <label class="form-check-label" for="typeBudgetRadio1">
            Receita
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input
            class="form-check-input"
            type="radio"
            value="D"
            formControlName="typeBudget"
          />
          <label class="form-check-label" for="typeBudgetRadio2">
            Despesa
          </label>
        </div>
        <div *ngIf="submitted && f.typeBudget.errors" class="text-danger">
          <div *ngIf="f.typeBudget.errors.required">
            Tipo de Orçamento Requerido
          </div>
        </div>
      </div>
      <label for="description" class="col-sm-6 control-label"
        >Descrição do Orçamento</label
      >
      <div class="col-sm-12">
        <input
          type="text"
          class="form-control"
          name="description"
          id="description"
          placeholder="Descrição do Orçamento"
          formControlName="description"
        />
        <div *ngIf="submitted && f.description.errors" class="text-danger">
          <div *ngIf="f.description.errors.required">Descrição Requerida</div>
        </div>
      </div>
    </div>
    <div class="form-group d-flex flex-wrap flex-column align-items-end">
      <label for="value" class="col-sm-6 control-label">Valor:</label>
      <div class="col-sm-6">
        <input
          type="text"
          currencyMask
          [options]="{ prefix: '€ ', thousands: '.', decimal: ',' }"
          class="form-control"
          name="value"
          id="value"
          placeholder="Valor"
          formControlName="value"
        />
        <div *ngIf="submitted && f.value.errors" class="text-danger">
          <div *ngIf="f.value.errors.required">Valor Requerido</div>
        </div>
      </div>
    </div>
    <div class="form-group d-flex flex-wrap flex-column align-items-end">
      <div class="col-sm-6">
        <label for="month" class="">Mês:</label>
        <select class="form-control" formControlName="month" (ngModelChange)="onMonthChangeSelect($event)">
          <option [ngValue]="null" disabled>Selecione o mês</option>
          <option *ngFor="let m of months" [ngValue]="m.id">
            {{ m.name }}
          </option>
        </select>
        <div *ngIf="submitted && f.month.errors" class="text-danger">
          <div *ngIf="f.month.errors.required">Mês Requerido</div>
        </div>
      </div>
    </div>
    <div class="form-check">
      <div class="col-sm-12">
        <label for="value" class="form-check-label">
          <input
              type="checkbox"
              class="form-check-input"
              name="default"
              id="default"
              formControlName="default"
            />Incluir automaticamente todos os meses.
        </label>
      </div>
    </div>
  </form>
</modal>

<modal #modalIndicator [modalConfig]="modalConfig">
  <div class="container container-fluid">
    <div class="row justify-content-center">
      <div class="col-6">
        <select class="form-control" name="budgetId" id="budgetId" [(ngModel)]="budgetId" (change)="changeBudget($event.target.value)" >
          <option *ngFor="let b of budgets" [value]="b.id">{{b.description}}</option>
        </select>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-12">
        <div style="display: block;">
          <canvas baseChart="baseChart" width="400" height="400" [datasets]="lineChartData" [labels]="lineChartLabels" [colors]="lineChartColors" [legend]="lineChartLegend" [chartType]="lineChartType" [plugins]="lineChartPlugins"></canvas>
        </div>
      </div>
    </div>
  </div>
</modal>
